<!DOCTYPE html>
<html>
<head>
  <title>股票交易檢討系統</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/table_style.css') }}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

</head>
    {% include 'navbar.html' %}

<body><!-- 下拉列表 -->
    <div class="table-outbox">
    <h1>績效報表總攬</h1>
      <table>
        <thead>
          <tr>
            <th>交易期間</th>
            <th>股票名稱</th>
            <th>獲利</th>
            <th>報酬率</th>
            <th>交易筆數</th>
            <th>狀態</th>
            <th>使用規則</th>
            <th>編輯</th>
            <th>刪除</th>
          </tr>
        </thead>
        <tbody>
            {% for review in reviews %}
                <tr>
                    <td>{{ review['交易期間'] }}</td>
                    <td>{{ review['股票名稱'] }}</td>
                    <td>{{ review['獲利'] }}</td>
                    <td>{{ review['報酬率'] }}</td>
                    <td>{{ review['交易筆數'] }}</td>
                    <td>{{ review['狀態'] }}</td>
                    <td>{{ review['使用規則'] }}</td>
                    <td>
                        <form action="{{ url_for('add_review', review_id=review['review_id']) }}" method="get">
                            <!-- 創建一個按鈕 -->
                            <input type="submit" value="編輯交易">
                        </form>
                    </td>
                    <td>
                        <form action="{{ url_for('delete_review', review_id=review['review_id']) }}" method="get">
                            <!-- 創建一個按鈕 -->
                            <input type="submit" value="刪除交易">
                        </form>
                    </td>
                    
                    
                </tr>
            {% endfor %}

        </tbody>
      </table>
      
    </div>
    <form action="{{ url_for('add_review') }}" method='get'>
      <select id="rule" name="rule">
        <option value="" selected disabled>卡組名稱</option>

        {% for item in items %}
        <option value="{{ item['使用規則'] }}">{{ item['使用規則'] }}</option>
        {% endfor %}
      </select>

      <!-- 選項列表 -->
      <select id="options" name="options">
        <option value="" selected disabled>股票名稱</option>
      </select>
      <input type="submit" value="Submit">
  </form>


    <script>
    // 獲取下拉列表和選項列表元素
    const ruleSelect = document.querySelector('#rule');
    const optionsSelect = document.querySelector('#options');

    // 監聽下拉列表的 change 事件
    ruleSelect.addEventListener('change', () => {
      // 獲取用戶選擇的類別
      const rule = ruleSelect.value;
      
      // 使用 AJAX 向後端發送請求以獲取相應的選項
      fetch(`/options?rule=${rule}`)
        .then(response => response.json())
        .then(options => {
          // 清空選項列表
          optionsSelect.innerHTML = '';
          
          // 添加新的選項到選項列表中
          for (const option of options) {
            const optionElement = document.createElement('option');
            optionElement.value = option;
            optionElement.textContent = option;
            optionsSelect.appendChild(optionElement);
          }
        });
    });
    </script>


</body>
</html>